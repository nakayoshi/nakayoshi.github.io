(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5890:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ie}});var r=n(29),s=n(7794),i=n.n(s),a=n(8767),o=n(2777),p=n(2262),u=n(9499),d=function(){function e(t){(0,o.Z)(this,e),(0,u.Z)(this,"message",void 0),this.message=t}return(0,p.Z)(e,[{key:"act",value:function(){var e=(0,r.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),c=function(){function e(t){(0,o.Z)(this,e),(0,u.Z)(this,"user",void 0),this.user=t}return(0,p.Z)(e,[{key:"act",value:function(){var e=(0,r.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),l=function(){function e(t,n){(0,o.Z)(this,e),(0,u.Z)(this,"user",void 0),(0,u.Z)(this,"delayed",void 0),this.user=t,this.delayed=n}return(0,p.Z)(e,[{key:"sleep",value:function(){var e=(0,r.Z)(i().mark((function e(){var t=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,1e3*t.delayed)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"act",value:function(){var e=(0,r.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sleep();case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),y="OgpMessage",g="MetaMessage",h=JSON.parse('[{"type":"SendMessage","message":{"text":"nakayoshi.dance\u304c\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f","type":"MetaMessage"}},{"type":"StartTyping","user":"Meta"},{"type":"EndTyping","user":"Meta","delayed":0.4},{"type":"SendMessage","message":{"text":"\u8a2a\u554f\u8005\u304c\u30ed\u30b0\u30a4\u30f3\u3057\u307e\u3057\u305f","type":"MetaMessage"}},{"type":"EndTyping","user":"Others","delayed":0.4},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":1},{"type":"SendMessage","message":{"text":"nakayoshi.dance\u3078\u3088\u3046\u3053\u305d","type":"TextMessage","user":"Others"}},{"type":"StartTyping","user":"Self"},{"type":"EndTyping","user":"Self","delayed":0.8},{"type":"SendMessage","message":{"text":"\u3048\u3001\u3060\u308c\uff1f","type":"TextMessage","user":"Self"}},{"type":"EndTyping","user":"Others","delayed":0.4},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":0.8},{"type":"SendMessage","message":{"text":"\u79c1\u305f\u3061\u306f\u79c1\u305f\u3061\u306e\u3053\u3068\u3092\u56e3\u4f53\u3067\u3042\u308b\u3068\u306f\u8003\u3048\u3066\u3044\u307e\u305b\u3093","type":"TextMessage","user":"Others"}},{"type":"EndTyping","user":"Others","delayed":0.2},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":0.8},{"type":"SendMessage","message":{"text":"\u3042\u304f\u307e\u3067\u500b\u4eba\u9593\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u306a\u306e\u3067\u3059","type":"TextMessage","user":"Others"}},{"type":"StartTyping","user":"Self"},{"type":"EndTyping","user":"Self","delayed":0.8},{"type":"SendMessage","message":{"text":"\u305d\u308c\u3092\u56e3\u4f53\u3063\u3066\u3044\u3046\u3093\u3058\u3083\u306a\u3044\u306e\uff1f","type":"TextMessage","user":"Self"}},{"type":"EndTyping","user":"Others","delayed":0.2},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":3},{"type":"SendMessage","message":{"text":"\u3046\u308b\u3055\u3044\u3070\u304b","type":"TextMessage","user":"Others"}},{"type":"EndTyping","user":"Others","delayed":1},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":2},{"type":"SendMessage","message":{"text":"\u3082\u3057\u8208\u5473\u304c\u3042\u308c\u3070Discord\u306e\u30ea\u30f3\u30af\u3092\u5dee\u3057\u4e0a\u3052\u307e\u3059\u304c\uff1f","type":"TextMessage","user":"Others"}},{"type":"EndTyping","user":"Self","delayed":0.4},{"type":"StartTyping","user":"Self"},{"type":"EndTyping","user":"Self","delayed":1},{"type":"SendMessage","message":{"text":"\u3048\u3047...\uff1f\u5225\u306b\u3044\u3089\u306a\u3044\u304b\u306a\u3002","type":"TextMessage","user":"Self"}},{"type":"EndTyping","user":"Others","delayed":0.4},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":1},{"type":"SendMessage","message":{"text":"https://github.com/nakayoshi/","type":"TextMessage","user":"Others","links":[{"linkText":"https://github.com/nakayoshi/","url":"https://github.com/nakayoshi/"}]}},{"type":"EndTyping","user":"Others","delayed":0.4},{"type":"SendMessage","message":{"type":"OgpMessage","user":"Others","ogp":{"size":"Large","title":"\u306a\u304b\u3088\u3057","description":"Discord\u30b5\u30fc\u30d0\u30fc\u300c\u306a\u304b\u3088\u3057\u300d. \u306a\u304b...","imagePath":"/nakayoshi.jpg","url":"https://github.com/nakayoshi/"}}},{"type":"EndTyping","user":"Self","delayed":0.2},{"type":"StartTyping","user":"Self"},{"type":"EndTyping","user":"Self","delayed":1},{"type":"SendMessage","message":{"text":"GitHub\u3084\u3093\u3051","type":"TextMessage","user":"Self"}},{"type":"EndTyping","user":"Others","delayed":1},{"type":"StartTyping","user":"Others"},{"type":"EndTyping","user":"Others","delayed":2},{"type":"SendMessage","message":{"text":"\u79c1\u305f\u3061\u306b\u3064\u3044\u3066\u3082\u3063\u3068\u77e5\u308a\u305f\u3044\u306e\u306a\u3089\\n/about\\n\u307e\u305f\u8a71\u3057\u305f\u3044\u6642\u306b\u306f\\n/contact\\n\u306b\u30a2\u30af\u30bb\u30b9\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u3067\u306f\u3002","type":"TextMessage","user":"Others","links":[{"linkText":"/about","url":"/about"},{"linkText":"/contact","url":"/contact"}]}},{"type":"EndTyping","user":"Others","delayed":0.4},{"type":"SendMessage","message":{"type":"OgpMessage","user":"Others","ogp":{"size":"Small","title":"About","description":"\u79c1\u9054\u306e\u3053\u3068\u3092\u77e5\u308b","imagePath":"/nakayoshi.jpg","url":"/about"}}},{"type":"EndTyping","user":"Others","delayed":0.1},{"type":"SendMessage","message":{"type":"OgpMessage","user":"Others","ogp":{"size":"Small","title":"Contact","description":"\u8a71\u3057\u305f\u3044\uff1f","imagePath":"/nakayoshi.jpg","url":"/contact"}}},{"type":"EndTyping","user":"Others","delayed":1},{"type":"SendMessage","message":{"text":"nakayoshi.dance\u304c\u30ed\u30b0\u30a2\u30a6\u30c8\u3057\u307e\u3057\u305f","type":"MetaMessage"}},{"type":"EndTyping","user":"Self","delayed":1},{"type":"SendMessage","message":{"text":"\u3044\u306a\u304f\u306a\u3063\u3061\u3083\u3063\u305f\u30fb\u30fb\u30fb","type":"TextMessage","user":"Self"}}]');function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,s=function(){};return{s:s,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw i}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(){function e(){(0,o.Z)(this,e),(0,u.Z)(this,"story",void 0),this.story=[]}return(0,p.Z)(e,[{key:"know",value:function(e){this.story.push(e)}},{key:"tell",value:function(){var e=(0,r.Z)(i().mark((function e(t){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.checkIndex(t)){e.next=2;break}throw new Error("no index");case 2:return n=this.story[t],e.next=5,n.act();case 5:if(r=e.sent,this.hasNext(t)){e.next=8;break}return e.abrupt("return",{result:r,nextIndex:void 0});case 8:return e.abrupt("return",{result:r,nextIndex:t+1});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkIndex",value:function(e){return this.story.length>e}},{key:"hasNext",value:function(e){return this.story.length-1>e}}],[{key:"fromPreparedJson",value:function(){var t,n=new e,r=m(h);try{for(r.s();!(t=r.n()).done;){var s=t.value;if("SendMessage"===s.type){var i,a=s.message,o=null===a||void 0===a?void 0:a.user,p=null!==(i=null===a||void 0===a?void 0:a.type)&&void 0!==i?i:g,u=null!==a&&void 0!==a&&a.ogp?x(x({},a.ogp),{size:a.ogp.size}):void 0;n.know(new d({text:null===a||void 0===a?void 0:a.text,userType:o,type:p,links:null===a||void 0===a?void 0:a.links,ogp:u}))}else if("StartTyping"===s.type){var y=s.user;n.know(new c(y))}else{if("EndTyping"!==s.type)throw new Error("invalid action");var f,v=s.user,w=null!==(f=s.delayed)&&void 0!==f?f:0;n.know(new l(v,w))}}}catch(b){r.e(b)}finally{r.f()}return n}}]),e}(),b=w.fromPreparedJson(),T=function(){var e=(0,r.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.tell(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=n(2125),j=n(7294),M=n(1664),S=n.n(M),k=n(5893),_=O.ZP.a.withConfig({displayName:"ChatOgpMessage__Wrapper",componentId:"sc-13e4r5l-0"})(["display:flex;flex-direction:column;width:100%;border-radius:8px;&{box-shadow:2px 2px 4px #000;}"]),P=O.ZP.div.withConfig({displayName:"ChatOgpMessage__OgpImageContainer",componentId:"sc-13e4r5l-1"})(["width:100%;height:140px;"]),E=O.ZP.img.withConfig({displayName:"ChatOgpMessage__OgpImage",componentId:"sc-13e4r5l-2"})(["border-radius:8px 8px 0px 0px;object-fit:cover;width:100%;height:100%;"]),Z=O.ZP.div.withConfig({displayName:"ChatOgpMessage__OgpText",componentId:"sc-13e4r5l-3"})(["width:100%;display:flex;flex-direction:column;padding:10px;& > h4{text-decoration:none;font-size:14px;font-weight:normal;padding-bottom:5px;text-align:left;color:#000;}& > span{font-size:12px;text-align:left;color:#000;}& > :last-child{color:rgba(0,0,0,0.4);}"]),C=O.ZP.div.withConfig({displayName:"ChatOgpMessage__SmallWrapper",componentId:"sc-13e4r5l-4"})(["display:flex;height:110px;width:100%;&{box-shadow:2px 2px 4px #000;}"]),I=O.ZP.div.withConfig({displayName:"ChatOgpMessage__SmallOgpText",componentId:"sc-13e4r5l-5"})(["width:70%;display:flex;flex-direction:column;padding:10px;& :only-child{padding-left:5px;}& > h4{text-decoration:none;font-size:14px;font-weight:normal;padding-bottom:10px;}& > span{font-size:12px;}& > :last-child{color:rgba(0,0,0,0.4);}"]),N=O.ZP.div.withConfig({displayName:"ChatOgpMessage__SmallImageContainer",componentId:"sc-13e4r5l-6"})(["height:100%;display:flex;justify-content:center;align-items:center;& > div{height:80px;width:80px;padding:10px;}img{border-radius:8px;}"]),z=function(e){var t=e.ogp;return"Large"===t.size?(0,k.jsx)(S(),{href:t.url,children:(0,k.jsxs)(_,{children:[(0,k.jsx)(P,{children:(0,k.jsx)(E,{src:t.imagePath,alt:t.title})}),(0,k.jsxs)(Z,{children:[(0,k.jsx)("h4",{children:t.title}),(0,k.jsx)("span",{children:t.description}),(0,k.jsx)("span",{children:t.url})]})]})}):(0,k.jsx)(S(),{href:t.url,children:(0,k.jsxs)(C,{children:[(0,k.jsxs)(I,{children:[(0,k.jsx)("h4",{children:t.title}),(0,k.jsx)("span",{children:t.description}),(0,k.jsx)("a",{children:t.url})]}),(0,k.jsx)(N,{children:(0,k.jsx)("div",{children:(0,k.jsx)(E,{src:t.imagePath,alt:t.title})})})]})})},W="Self",A="Others",F=O.ZP.li.withConfig({displayName:"ChatMessage__MessageWrapper",componentId:"sc-581pa3-0"})(["display:flex;align-items:center;width:100%;justify-content:",";& > div{width:",";padding:",";background-color:",";}"],(function(e){return function(e){switch(e){case W:return"flex-end";case A:return"flex-start";default:return"center"}}(e.userType)}),(function(e){return e.messageType===y?"60%":"auto"}),(function(e){return function(e){switch(e){case"TextMessage":return"10px";case y:return"0";case g:return"2px 20px";default:return"10px"}}(e.messageType)}),(function(e){return function(e){switch(e){case W:return"#93df84";case A:return"white";default:return"rgba(229, 229, 229, 0.5)"}}(e.userType)})),D=O.ZP.div.withConfig({displayName:"ChatMessage__MessageBaloon",componentId:"sc-581pa3-1"})(["border-radius:8px;margin:10px 20px;max-width:250px;font-size:14px;& > span{display:block;color:rgba(0,0,0,0.9);}a{color:#7f93c4;}"]),B=O.ZP.div.withConfig({displayName:"ChatMessage__MetaMessageBaloon",componentId:"sc-581pa3-2"})(["margin:10px;border-radius:20px;font-size:12px;& > span{color:rgba(255,255,255,0.8);}"]),L=function(e){var t=e.links,n=e.text;if(!n)return[""];if(!t)return[n];return function e(n,r){var s=t[n],i=r.map((function(e){return function(e,t){var n=new RegExp("(".concat(t,")"));return e.split(n)}(e,s.linkText)}));return t.length>n+1?e(n+1,i.flat()):i.flat()}(0,[n])},J=function(e){var t=e.message,n=e.onMounted,r=e.isLast;(0,j.useEffect)((function(){r||n()}),[n,r]);var s=(0,j.useMemo)((function(){var e=function(e){var t=L(e),n=e.links;return n?t.map((function(e){var t=n.filter((function(t){return t.linkText===e}));if(0===t.length)return e;var r=t[0];return(0,k.jsx)(S(),{href:r.url,children:(0,k.jsx)("a",{children:r.url})})})):[e.text]}(t);return(0,k.jsx)("span",{children:e.map((function(e,t){return(0,k.jsx)("p",{children:e},t)}))})}),[t]);if(!t)return(0,k.jsx)("div",{});var i=t.userType,a=t.type,o=t.ogp;return(0,k.jsx)(F,{userType:i,messageType:a,children:i?o?(0,k.jsx)(D,{children:(0,k.jsx)(z,{ogp:o})}):(0,k.jsx)(D,{children:s}):(0,k.jsx)(B,{children:s})})},X=(0,O.F4)(["0%{opacity:20%;}25%{opacity:50%;}50%{opacity:100%;}75%{opacity:50%;}100%{opacity:20%;}"]),G=O.ZP.div.withConfig({displayName:"Typing__TypingCircle",componentId:"sc-11cktun-0"})(["opacity:20;animation:"," 0.8s infinite;animation-delay:","ms;height:12px;width:12px;margin:0 2px;border-radius:50%;background-color:#7d7d7d;"],X,(function(e){return e.delay?e.delay:0})),H=O.ZP.div.withConfig({displayName:"Typing__Wrapper",componentId:"sc-11cktun-1"})(["display:flex;"]),R=function(e){return e.isTyping?(0,k.jsxs)(H,{children:[(0,k.jsx)(G,{}),(0,k.jsx)(G,{delay:200}),(0,k.jsx)(G,{delay:400})]}):(0,k.jsx)("div",{})},Q=O.ZP.ol.withConfig({displayName:"ChatView__Wrapper",componentId:"sc-ak1ofz-0"})(["background-color:#292841;width:100%;padding:10px 0;overflow-y:scroll;"]),U=function(){var e=(0,j.useRef)(null),t=(0,a.useInfiniteQuery)("chats",function(){var e=(0,r.Z)(i().mark((function e(t){var n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageParam,r=void 0===n?0:n,e.next=3,T(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{getNextPageParam:function(e){return e.nextIndex||void 0}}),n=t.data,s=t.fetchNextPage,o=t.hasNextPage;return(0,j.useEffect)((function(){var t;e.current&&e.current.scrollTo({top:null===(t=e.current)||void 0===t?void 0:t.scrollHeight,behavior:"smooth"})}),[n]),(0,k.jsx)(Q,{ref:e,children:null===n||void 0===n?void 0:n.pages.map((function(e,t){if(e.result instanceof d)return(0,k.jsx)(J,{message:e.result.message,onMounted:function(){return s()},isLast:!o},t);if(e.result instanceof c){if(e.result.user===A&&(null===n||void 0===n?void 0:n.pages.length)===t+1)return(0,k.jsx)(F,{userType:A,children:(0,k.jsx)(D,{children:(0,k.jsx)(R,{isTyping:!0})})},t)}else if(e.result instanceof l)return}))})},V=n(1436),$=n(2814),q=O.ZP.div.withConfig({displayName:"MessageField__Wrapper",componentId:"sc-11vpmh1-0"})(["display:flex;justify-content:center;background-color:#fff;padding:10px;align-items:center;height:54px;box-shadow:0 2px 5px black;"]),K=O.ZP.input.withConfig({displayName:"MessageField__InputField",componentId:"sc-11vpmh1-1"})(["border:2px solid #e5e5e5;border-radius:20px;flex-grow:1;margin-right:10px;height:30px;padding-left:10px;"]),Y=O.ZP.div.withConfig({displayName:"MessageField__SendButtonWrapper",componentId:"sc-11vpmh1-2"})([""]),ee=O.ZP.button.withConfig({displayName:"MessageField__SendButton",componentId:"sc-11vpmh1-3"})(["background-color:#7f93c4;border-radius:20px;display:flex;padding:10px 15px;justify-content:center;align-items:center;"]),te=function(){return(0,k.jsx)($.G,{icon:V.XCy})},ne=O.ZP.span.withConfig({displayName:"MessageField__SendButtonLabel",componentId:"sc-11vpmh1-4"})(["color:#fff;font-size:16px;display:flex;justify-content:center;align-items:center;height:20px;width:20px;"]),re=function(){return(0,k.jsxs)(q,{children:[(0,k.jsx)(K,{disabled:!0}),(0,k.jsx)(Y,{children:(0,k.jsx)(ee,{children:(0,k.jsx)(ne,{children:(0,k.jsx)(te,{})})})})]})},se=O.ZP.div.withConfig({displayName:"pages__Wrapper",componentId:"sc-zkkk7x-0"})(["display:flex;flex-direction:column;height:auto;width:auto;background-color:#292841;width:100%;height:100%;& > ul:first-child{position:relative;top:0;padding-bottom:74px;}& > div:last-child{position:fixed;right:0;bottom:0;left:0;}"]),ie=function(){return(0,k.jsxs)(se,{children:[(0,k.jsx)(U,{}),(0,k.jsx)(re,{})]})}},8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5890)}])}},function(e){e.O(0,[523,324,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);